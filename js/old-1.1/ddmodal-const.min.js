/*!
  * DDModal
  * Author: Nguyen Hieu Dien (nguyenhieudien@hotmail.com)
  * nguyenhieudien.com/ddmodal
  */
$(document).ready(function(){DDModal()});const ERR_ELEMENTLOAD="ERROR WHEN LOAD ELEMENT SELECTOR",ERR_URLLOAD="ERROR WHEN LOAD URL: ",ERR_URLELEMENTLOAD="ERROR WHEN LOAD ELEMENT IN URL";var DDModal=function(){var bttarget,bttype,btclick,btlabel,btclass,mdid,mdtitle,mdinclude,mdclass,resizable,draggable,error="",ddmodal="";let tags=document.getElementsByTagName("ddmodal");for(;tags.length>0;)ddmodaltag=tags[0],bttarget=bttype=btclick=btlabel=btclass=mdid=mdtitle=mdinclude=mdclass="",bttarget=ddmodaltag.getAttribute("id")?ddmodaltag.getAttribute("id"):"",bttype=ddmodaltag.getAttribute("bttype")?ddmodaltag.getAttribute("bttype"):"",btclick=ddmodaltag.getAttribute("btclick")?ddmodaltag.getAttribute("btclick"):"",btlabel=ddmodaltag.getAttribute("btlabel")?ddmodaltag.getAttribute("btlabel"):"",btclass=ddmodaltag.getAttribute("btclass")?ddmodaltag.getAttribute("btclass"):"",mdid=ddmodaltag.getAttribute("id")?ddmodaltag.getAttribute("id"):"",mdtitle=ddmodaltag.getAttribute("mdtitle")?ddmodaltag.getAttribute("mdtitle"):"",mdinclude=ddmodaltag.getAttribute("mdinclude")?ddmodaltag.getAttribute("mdinclude"):"",mdclass=ddmodaltag.getAttribute("mdclass")?ddmodaltag.getAttribute("mdclass"):"",resizable=ddmodaltag.getAttribute("resizable"),draggable=ddmodaltag.getAttribute("draggable"),""===mdid&&(error+="Attribute id is require! "),""===mdinclude&&(error+="Attribute mdinclude is require! "),ddmodal=""===error?createModal(bttarget,bttype,btclick,btlabel,btclass,mdid,mdtitle,mdinclude,mdclass,resizable,draggable):error,ddmodaltag.outerHTML=ddmodal,UISet("#"+mdid,resizable,draggable)};function createModal(bttarget,bttype,btclick,btlabel,btclass,mdid,mdtitle,mdinclude,mdclass,resizable,draggable){var ddmodal="",modalButton="",modalForm="";(bttype||"#"!==btclick||btlabel||btclass)&&(ddmodal+=modalButton=ModalButton(bttarget,bttype,btclick,btlabel,btclass));var modalaction="loadtag";if(FILEFORMAT.forEach(function(element){if(-1!==mdinclude.indexOf(element))return modalaction="loadfile",!1}),"loadtag"===modalaction&&(mdbody=getMDContentFromTag(mdinclude)),"loadfile"===modalaction){const spaceindex=mdinclude.indexOf(" ");if(-1===spaceindex)mdbody=getMDContentFromFile(mdinclude);else{var filepath=mdinclude.substring(0,spaceindex),element=mdinclude.substring(spaceindex+1);mdbody=getMDContentFromFileTag(mdid,filepath,element)}}return ddmodal+=modalForm=ModalForm(mdid,mdtitle,mdbody,mdclass)}function getMDContentFromTag(element){var mdbody="";return $(element).length?(mdbody=$(element)[0].outerHTML,$(element).remove()):mdbody=ERR_ELEMENTLOAD,mdbody}function getMDContentFromFile(filepath){var file=ROOTPATH+filepath,mdbody="",xhttp=new XMLHttpRequest;return xhttp.open("GET",file,!1),xhttp.onreadystatechange=function(){mdbody=4==this.readyState&&200==this.status?this.responseText:ERR_URLLOAD+xhttp.status+" "+xhttp.statusText},xhttp.send(null),mdbody}function getMDContentFromFileTag(mdid,filepath,element){const ddmodalid="#"+mdid;var mdbody="",filecontent=getMDContentFromFile(filepath);return $(ddmodalid).append(filecontent),mdbody=$(ddmodalid+" "+element).length?$(ddmodalid+" "+element)[0].outerHTML:ERR_URLELEMENTLOAD,$(ddmodalid).innerHTML="",mdbody}var ModalButton=function(bttarget,bttype,btclick,btlabel,btclass){var html="";return btclass=btclass||"btn-primary","button"===bttype?(html+="<"+bttype+' onclick="'+btclick+'" class="btn '+btclass+'" data-toggle="modal" data-target="#'+bttarget+'">',html+=btlabel,html+="</"+bttype+">"):(html+='<a href="'+btclick+'" class="btn '+btclass+'" data-toggle="modal" data-target="#'+bttarget+'">',html+=btlabel,html+="</a>"),html},ModalForm=function(mdid,mdtitle,mdbody,mdclass){var htmlheader,htmlbody,html,mdclass=splitMDClass(mdclass);return htmlheader=htmlbody=html="",mdtitle&&(BOOTSTRAPVER<4?(htmlheader='<div class="modal-header'+mdclass.headerclass+'">',htmlheader+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',htmlheader+='<h4 class="modal-title">'+mdtitle+"</h4>",htmlheader+="</div>"):(htmlheader='<div class="modal-header'+mdclass.headerclass+'">',htmlheader+='<h4 class="modal-title">'+mdtitle+"</h4>",htmlheader+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>',htmlheader+="</div>")),htmlbody='<div class="modal-body'+mdclass.bodyclass+'">',htmlbody+=mdbody,htmlbody+="</div>",html='<div class="modal fade" id="'+mdid+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-show="true">',html+='<div class="modal-dialog'+mdclass.modalclass+'" role="document">',html+='<div class="modal-content">',html+=htmlheader,html+=htmlbody,html+="</div>",html+="</div>",html+="</div>"};function splitMDClass(mdclass){var mdclassresult=[],mdclassarr;return mdclassresult.headerclass="",mdclassresult.bodyclass="",mdclassresult.modalclass="",mdclass.split(" ").forEach(function(element){-1!==element.indexOf("md-header")?mdclassresult.headerclass+=" "+element:-1!==element.indexOf("md-body")?mdclassresult.bodyclass+=" "+element:mdclassresult.modalclass+=" "+element}),mdclassresult}